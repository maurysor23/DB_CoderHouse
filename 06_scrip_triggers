/*1 PRIMERAMENTE SE PROCEDIÓ A LA CREACIÓN DE UNA NUEVA TABLA LLAMADA (LOG_LLAMADAS), EN EL CUAL EN ESTA MISMA SE VAN A ALMACENAR LOS DATOS DE USUARIO 
QUE REALIZO UNA DETERMINADA MODIFICACIÓN EN LA TABLA (LLAMADAS), QUE EN ESTE CASO EN PARTICULAR ES LA INSERCIÓN DE NUEVOS REGISTROS A LA TABLA ANTES MENCIONADA.
POSTERIORMENTE SE REALIZA LA CREACIÓN DE UN TRIGGERS QUE SE EJECUTARÁ DE MANERA AUTOMÁTICAMENTE EN RESPUESTA A CIERTOS EVENTOS QUE SE REALICEN EN LA TABLA LLAMADAS.
PARA FINALIZAR Y QUE SE EJECUTE EL TRIGGER, SE PROCEDE A LA INSERCIÓN DE UN NUEVO REGISTRO A LA TABLA LLAMADAS PARA PODER VISUALIZAR LOS DATOS OBTENIDOS DE MANERA
AUTOMÁTICA EN LA TABLA (LOG_LLAMADAS) */


CREATE TABLE log_llamadas(
 Id_Llamadas INT PRIMARY KEY,
 Razon_Llamada varchar (20),
 user_id VARCHAR(300),
 fecha_insert date,
 hora_insert time 
);

CREATE TRIGGER tr_add_log_llamadas
AFTER INSERT ON llamadas
FOR EACH ROW
INSERT INTO log_llamadas (Id_Llamadas, Razon_Llamada, user_id, fecha_insert, hora_insert)
VALUES (NEW.Id_Llamadas, NEW.Razon_Llamada, USER(), NOW(), NOW());

INSERT INTO llamadas (Id_Llamadas, id_clientes, razon_llamada, calificacion_llamada)
VALUES (202, "7818-00", "Ventas", 5)


/*2 PRIMERAMENTE SE PROCEDIÓ A LA CREACIÓN DE UNA NUEVA TABLA LLAMADA (LOG_LLAMADAS_DELETE), EN EL CUAL EN ESTA MISMA SE VAN A ALMACENAR LOS DATOS DE USUARIO 
QUE REALIZO UNA DETERMINADA MODIFICACIÓN EN LA TABLA (LLAMADAS), QUE EN ESTE CASO EN PARTICULAR ES LA ELIMINACIÓN DE UN REGISTROS DE LA TABLA ANTES MENCIONADA.
POSTERIORMENTE SE REALIZA LA CREACIÓN DE UN TRIGGERS QUE SE EJECUTARÁ DE MANERA AUTOMÁTICAMENTE EN RESPUESTA A CIERTOS EVENTOS QUE SE REALICEN EN LA TABLA LLAMADAS
PARA FINALIZAR Y QUE SE EJECUTE EL TRIGGER, SE PROCEDE A LA ELIMINACIÓN DE UN NUEVO REGISTRO DE LA TABLA LLAMADAS PARA PODER VISUALIZAR LOS DATOS OBTENIDOS DE MANERA
AUTOMÁTICA EN LA TABLA (LOG_LLAMADAS_DELETE) */


CREATE TABLE log_llamadas_delete(
 Id_llamadas INT PRIMARY KEY,
 accion varchar (200),
 user_id VARCHAR(300),
 fecha_insert date,
 hora_insert time 
);

CREATE TRIGGER tr_add_llamadas_delete
BEFORE DELETE ON llamadas
FOR EACH ROW
INSERT INTO log_llamadas_delete (Id_llamadas, accion, user_id, fecha_insert, hora_insert)
VALUES (OLD.Id_llamadas,'SE ELIMINO ESTE REGISTRO', USER(), NOW(), NOW());

DELETE FROM llamadas
WHERE Id_Llamadas = 203;
